# -*- mode: c; c-basic-offset: 4; indent-tabs-mode: nil; -*-
# vim:expandtab:shiftwidth=4:tabstop=4:
%include "common.conf"

define_policy hsm_archive {
    scope { type == file
            and no_archive != 1
            and (status == new or status == modified) }
    status_manager = lhsm(archive);
    status_current = archiving;
    default_action = lhsm.archive;
    default_lru_sort_attr = last_mod;
}

hsm_archive_parameters {
    nb_threads = 1;

    max_action_volume  = 10GB;
    max_action_count   = 200;
    db_result_size_max = 80;
    lru_sort_attr      = last_mod ;  # (from 'define_policy' block)

    # default action parameters
    action_params {
        archive_id = 1;
    }
}

hsm_archive_rules {
    rule archive_std {
        target_fileclass = 'lustre_files';
        condition { last_mod > 1 AND last_access > 1 }
    }
}

hsm_archive_trigger {
    trigger_on = periodic;
    check_interval = 60min;
}

FileClass lustre_files {
    definition { type == file }
    # report = yes (default)
}
