%include "common.conf"

fileclass testfile {
	definition { name == "file*" }
}

migration_trigger {
	trigger_on = periodic;
	check_interval = 5s;
}

migration_parameters {
	schedulers = rate_limit.tbf;
	tbf {
                # TBF sets a limit of <max_ops_count> operations per <period>
		max_ops_count = $ratelim_capacity;
		refill_period = $ratelim_refill;
	}
}

migration_rules {
    rule all {
	target_fileclass = testfile;

	condition { last_mod >= 1s }
	action_params {class = "{fileclass}";}
    }

    rule default {
        condition { last_mod >= 1s }
        action_params {class = "unmatched";}
    }
}
